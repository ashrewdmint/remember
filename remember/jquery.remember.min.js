(function(d){d.remember={key_name:"jquery.remember",return_methods:["hasChanges","changes","last","serialize"],silent_methods:["save","restore","forget"],first_only_methods:["last","serialize"],serialize:function(a,e){var b,c=[];a.find("[name]:input").each(function(){b=d(this);b.attr("type").match(/radio|checkbox/)&&!b.attr("checked")||c.push(escape(b.attr("name"))+"="+escape(b.val()))});c=c.join("&");if(e)c=this.objectFromParams(c);return c},restore:function(a){a=d(a);var e=this.objectFromParams(this.last(a));
a.find("[name]").each(function(){var b=d(this),c=b.attr("name");e[c]||b.attr("checked",false)});d.each(e,function(b,c){b=a.find("[name="+b+"]");var f=b.attr("type");if(b.length)if(b.get(0).nodeName.toLowerCase()=="textarea")b.text(c);else switch(f){case "radio":b.each(function(){d(this).val()==c?d(this).attr("checked",true):d(this).attr("checked",false)});break;case "checkbox":b.attr("checked",true);break;default:b.val(c);break}})},save:function(a){this.forget(a);this.last(a)},last:function(a,e){var b=
a.data(this.key_name);b=b?b:this.serialize(a);a.data(this.key_name,b);if(e)b=this.objectFromParams(b);return b},hasChanges:function(a){return this.last(a)!=this.serialize(a)},changes:function(a){var e=this.objectFromParams(this.serialize(a)),b=this.objectFromParams(this.last(a)),c=[];fields=d.extend({},e,b);d.each(fields,function(f,g){b[f]!=e[f]&&c.push({name:f,value:g,element:d("[name="+f+"]")})});return c},objectFromParams:function(a){var e={};a=a.split("&");d.each(a,function(b,c){c=unescape(c).split("=");
if(c.length>0)e[c[0]]=c[1]});return e},forget:function(a){return a.removeData(this.key_name)}};d.fn.remember=function(a,e){if(typeof a=="undefined")a="save";var b=this,c=null;if(d.inArray(a,d.remember.first_only_methods)>=0)b=b.eq(0);if(d.inArray(a,d.remember.return_methods)>=0){b.each(function(){var f=d.remember[a](d(this),e);switch(a){case "hasChanges":c||(c=f);break;case "changes":d.isArray(c)||(c=[]);d.each(f,function(){c.push(this)});break;default:c=f;break}});return c}else if(d.inArray(a,d.remember.silent_methods)>=
0)b.each(function(){d.remember[a](d(this))});else throw'Undefined method "'+a+'" for jQuery plugin remember';return this}})(jQuery);
